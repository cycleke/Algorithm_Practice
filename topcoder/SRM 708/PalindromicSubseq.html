<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>A palindrome is a string that reads the same forwards and backwards.
For example, "abba" and "racecar" are palindromes.</p>
<br></br>
<p>Limak has a string <b>s</b> consisting of N lowercase English letters.</p>
<br></br>
<p>For each valid i, let X[i] be the number of palidromic subsequences of <b>s</b> that contain the i-th character of <b>s</b>.</p>
<br></br>
<p>In other words:
For a fixed i, there are exactly 2^(N-1) ways to erase some characters of <b>s</b> other than the character <b>s</b>[i].
X[i] is the number of ways of erasing for which the string that remains is a palindrome.</p>
<br></br>
<p>For each i, compute the value Y[i] = ((i+1) * X[i]) modulo 1,000,000,007.
Then, compute and return the bitwise XOR of all the values Y[i].</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>PalindromicSubseq</td></tr><tr><td>Method:</td><td>solve</td></tr><tr><td>Parameters:</td><td>string</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int solve(string s)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>s</b> will contain exactly N characters.</td></tr><tr><td align="center" valign="top">-</td><td>N will be between 1 and 3000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each character in <b>s</b> will be a lowercase English letter 'a' - 'z'.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;aaba&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 30</pre></td></tr><tr><td><table><tr><td colspan="2"><p>For this string we have X = {5, 5, 3, 6}.
Thus, you should return the value (1*5) XOR (2*5) XOR (3*3) XOR (4*6) = 5 XOR 10 XOR 9 XOR 24 = 30.</p>
<br></br>
<p>Here is an explanation why X[0] = 5:
Given that we want to keep the character <b>s</b>[0], there are 8 possible subsequences of <b>s</b>:</p>
<pre>
a...  *
a..a  *
a.b.
a.ba  *
aa..  *
aa.a  *
aab.
aaba
</pre>
<p>Five of these subsequences (marked by stars) are palindromes.
Note that there are two different ways to produce the palindrome "aa".</p></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;abcd&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2">X[i] = 1 for all i. You should return (1*1) XOR (2*1) XOR (3*1) XOR (4*1) = 1 XOR 2 XOR 3 XOR 4 = 4.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;tcoct&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 60</pre></td></tr><tr><td><table><tr><td colspan="2">X[] = {7, 6, 4, 6, 7}</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;zyzyzzzzxzyz&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 717</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1025495382</pre></td></tr><tr><td><table><tr><td colspan="2"><p>If all characters are the same, all 2^N subsequences are palindromes.
For every index i all 2^(N-1) subseqeunces that contain it are palindromes.
It means that X[i] = 2^(N-1) for all i.</p>
<br></br>
<p>Note that in this case the answer exceeds the modulo value, because we return the XOR of modulo-ed values, without computing the modulo of that XOR.</p></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
